use moviedatabase;

create table actor(
 act_id int primary key not null,
act_name varchar(20),
act_gender varchar(1)
);

insert into actor values
(301,'ANUSHKA','F'),
(302,'PRABHAS','M'),
(303,'PUNTIH','M'),
(304,'JERMY','M');

CREATE TABLE DIRECTOR(
DIR_ID INT PRIMARY KEY NOT NULL,
DIR_NAME VARCHAR(20),
DIR_PHONE VARCHAR(10)
);

insert into DIRECTOR values
(60,'RAJAMOULI','8751611001'),
(61,'HITCHCOCK','7766138911'),
(63,'FARAN','9986776531'),
(64,'STEVEN SPIELBERG','8989776530');

CREATE TABLE MOVIES(
MOV_ID INT PRIMARY KEY NOT NULL,
MOV_TITLE VARCHAR(20),
MOV_YEAR INT,
MOV_LANG VARCHAR(10),
DIR_ID INT REFERENCES DIRECTOR(DIR_ID) 
);

INSERT INTO MOVIES VALUES
(1001,'BAHUBALI-2',2017,'TELAGU',60),
(1002,'BAHUBALI-1',2015,'TELAGA',60),
(1003,'AKASH',2008,'KANNADA',61),
(1004,'WAR HORSE',2011,'ENGLISH',63);

CREATE TABLE MOVIE_CAST
(
ACT_ID INT REFERENCES ACTOR(ACT_ID),
MOV_ID INT REFERENCES MOVIE(MOV_ID),
ROLE1 VARCHAR(10)
);

INSERT INTO MOVIE_CAST VALUES
(301,1002,'HEROINE'),
(301,1001,'HEROINE'),
(303,1003,'HERO'),
(303,1002,'GUEST'),
(304,1004,'HERO');

CREATE TABLE RATING
(
MOV_ID INT REFERENCES MOVIE(MOV_ID),
REV_STARS INT
);

INSERT INTO RATING VALUES
(1001,4),
(1002,2),
(1003,5),
(1004,4);

SELECT * FROM ACTOR;
SELECT * FROM DIRECTOR;
SELECT * FROM MOVIES;
SELECT * FROM movie_cast;
SELECT * FROM RATING;


-- Q1
SELECT MOV_TITLE FROM MOVIES WHERE DIR_ID IN
(SELECT DIR_ID FROM DIRECTOR WHERE DIR_NAME='HITCHCOCK');

-- Q2
SELECT MOV_TITLE FROM MOVIES WHERE MOV_ID IN
(SELECT MOV_ID FROM MOVIE_CAST GROUP BY ACT_ID HAVING COUNT(ACT_ID)>=2);

-- Q3
SELECT ACT_NAME FROM ACTOR A JOIN MOVIES M ON 
A.ACT_ID=M.MOV_ID WHERE MOV_YEAR<2000 AND MOV_YEAR>2015;

-- Q4
SELECT MOV_TITLE,REV_STARS FROM MOVIES M JOIN RATING R ON
M.MOV_ID=R.MOV_ID WHERE REV_STARS>=1 ORDER BY MOV_TITLE;

-- Q5
UPDATE RATING SET REV_STARS =5 
WHERE MOV_ID IN 
(SELECT MOV_ID FROM MOVIES WHERE DIR_ID IN 
(SELECT DIR_ID FROM DIRECTOR WHERE DIR_NAME='STEVEN SPIELBERG'));


